CONFIG
├── train
│   └── seed: 2222                                                              
│       name: null                                                              
│       interval: step                                                          
│       monitor: val/accuracy                                                   
│       mode: max                                                               
│       ema: 0.0                                                                
│       test: false                                                             
│       debug: false                                                            
│       ignore_warnings: false                                                  
│       state:                                                                  
│         mode: null                                                            
│         n_context: 0                                                          
│         n_context_eval: 0                                                     
│       ckpt: null                                                              
│       disable_dataset: false                                                  
│       validate_at_start: false                                                
│       pretrained_model_path: null                                             
│       pretrained_model_strict_load: true                                      
│       pretrained_model_state_hook:                                            
│         _name_: null                                                          
│       post_init_hook:                                                         
│         _name_: null                                                          
│       layer_decay:                                                            
│         _name_: null                                                          
│         decay: 0.7                                                            
│                                                                               
├── tolerance
│   └── logdir: ./resume                                                        
│       id: null                                                                
│                                                                               
├── wandb
│   └── project: TNLM                                                           
│       group: ''                                                               
│       job_type: training                                                      
│       mode: online                                                            
│       save_dir: .                                                             
│       id: null                                                                
│       name: rnn-mnist12                                                       
│                                                                               
├── trainer
│   └── accelerator: gpu                                                        
│       strategy: null                                                          
│       devices: 1                                                              
│       accumulate_grad_batches: 1                                              
│       max_epochs: 100                                                         
│       gradient_clip_val: null                                                 
│       log_every_n_steps: 10                                                   
│       limit_train_batches: 1.0                                                
│       limit_val_batches: 1.0                                                  
│       enable_model_summary: false                                             
│       track_grad_norm: -1                                                     
│                                                                               
├── loader
│   └── batch_size: 50                                                          
│       num_workers: 4                                                          
│       pin_memory: true                                                        
│       drop_last: true                                                         
│                                                                               
├── dataset
│   └── _name_: mnist                                                           
│       permute: true                                                           
│       val_split: 0.1                                                          
│       seed: 42                                                                
│                                                                               
├── task
│   └── _name_: base                                                            
│       loss: cross_entropy                                                     
│       metrics:                                                                
│       - accuracy                                                              
│       torchmetrics: null                                                      
│                                                                               
├── optimizer
│   └── _name_: adamw                                                           
│       lr: 0.0003                                                              
│       weight_decay: 0.05                                                      
│       betas:                                                                  
│       - 0.9                                                                   
│       - 0.999                                                                 
│                                                                               
├── scheduler
│   └── _name_: cosine_warmup                                                   
│       num_warmup_steps: 10800                                                 
│       num_training_steps: 108000                                              
│                                                                               
├── encoder
│   └── linear                                                                  
├── decoder
│   └── _name_: sequence                                                        
│       mode: pool                                                              
│                                                                               
├── model
│   └── layer:                                                                  
│         cell:                                                                 
│           _name_: rnn                                                         
│           hidden_activation: tanh                                             
│           orthogonal: false                                                   
│           d_input: 384                                                        
│           lr: 7.5e-05                                                         
│         _name_: rnn                                                           
│         return_output: true                                                   
│       _name_: model                                                           
│       prenorm: false                                                          
│       transposed: false                                                       
│       n_layers: 12                                                            
│       d_model: 384                                                            
│       bidirectional: false                                                    
│       residual: R                                                             
│       pool: null                                                              
│       norm: batch                                                             
│       dropout: 0.2                                                            
│       tie_dropout: true                                                       
│       track_norms: false                                                      
│       encoder: null                                                           
│       decoder: null                                                           
│                                                                               
└── callbacks
    └── learning_rate_monitor:                                                  
          logging_interval: step                                                
        timer:                                                                  
          step: true                                                            
          inter_step: false                                                     
          epoch: true                                                           
          val: true                                                             
        params:                                                                 
          total: true                                                           
          trainable: true                                                       
          fixed: true                                                           
        model_checkpoint:                                                       
          monitor: val/accuracy                                                 
          mode: max                                                             
          save_top_k: 1                                                         
          save_last: true                                                       
          dirpath: checkpoints/                                                 
          filename: val/accuracy                                                
          auto_insert_metric_name: false                                        
          verbose: true                                                         
        rich_model_summary:                                                     
          max_depth: 1                                                          
        rich_progress_bar:                                                      
          refresh_rate: 1                                                       
          leave: true                                                           
                                                                                
[rank: 0] Global seed set to 2222
wandb: Currently logged in as: yuqinzhou. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.15.5 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.4
wandb: Run data is saved locally in ./wandb/run-20230719_215957-bj4oecp8
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run rnn-mnist12
wandb: ⭐️ View project at https://wandb.ai/yuqinzhou/TNLM
wandb: 🚀 View run at https://wandb.ai/yuqinzhou/TNLM/runs/bj4oecp8
[2023-07-19 22:00:04,176][__main__][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-07-19 22:00:04,177][__main__][INFO] - Instantiating callback <src.callbacks.timer.Timer>
[2023-07-19 22:00:04,183][__main__][INFO] - Instantiating callback <src.callbacks.params.ParamsLog>
[2023-07-19 22:00:04,185][__main__][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-07-19 22:00:04,190][__main__][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-07-19 22:00:04,190][__main__][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
`Trainer(limit_train_batches=1.0)` was configured so 100% of the batches per epoch will be used..
`Trainer(limit_val_batches=1.0)` was configured so 100% of the batches will be used..
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
NOTE: no dropout inside recurrent cell
NOTE: no dropout inside recurrent cell
NOTE: no dropout inside recurrent cell
NOTE: no dropout inside recurrent cell
NOTE: no dropout inside recurrent cell
NOTE: no dropout inside recurrent cell
NOTE: no dropout inside recurrent cell
NOTE: no dropout inside recurrent cell
NOTE: no dropout inside recurrent cell
NOTE: no dropout inside recurrent cell
NOTE: no dropout inside recurrent cell
NOTE: no dropout inside recurrent cell
SequenceLightningModule(
  (model): SequenceModel(
    (drop): Identity()
    (layers): ModuleList(
      (0): SequenceResidualBlock(
        (layer): RNN(
          (cell): RNNCell(
            (W_hx): Linear(in_features=384, out_features=384, bias=False)
            (activate): Tanh()
            (W_hh): Linear(in_features=384, out_features=384, bias=False)
          )
        )
        (residual): Residual()
        (norm): Normalization(
          (norm): BatchNorm1d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (drop): Dropout1d(p=0.2, inplace=False)
        (output_linear): Sequential(
          (0): Conv1d(384, 768, kernel_size=(1,), stride=(1,))
          (1): GLU(dim=-2)
        )
        (activation): GELU(approximate=none)
      )
      (1): SequenceResidualBlock(
        (layer): RNN(
          (cell): RNNCell(
            (W_hx): Linear(in_features=384, out_features=384, bias=False)
            (activate): Tanh()
            (W_hh): Linear(in_features=384, out_features=384, bias=False)
          )
        )
        (residual): Residual()
        (norm): Normalization(
          (norm): BatchNorm1d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (drop): Dropout1d(p=0.2, inplace=False)
        (output_linear): Sequential(
          (0): Conv1d(384, 768, kernel_size=(1,), stride=(1,))
          (1): GLU(dim=-2)
        )
        (activation): GELU(approximate=none)
      )
      (2): SequenceResidualBlock(
        (layer): RNN(
          (cell): RNNCell(
            (W_hx): Linear(in_features=384, out_features=384, bias=False)
            (activate): Tanh()
            (W_hh): Linear(in_features=384, out_features=384, bias=False)
          )
        )
        (residual): Residual()
        (norm): Normalization(
          (norm): BatchNorm1d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (drop): Dropout1d(p=0.2, inplace=False)
        (output_linear): Sequential(
          (0): Conv1d(384, 768, kernel_size=(1,), stride=(1,))
          (1): GLU(dim=-2)
        )
        (activation): GELU(approximate=none)
      )
      (3): SequenceResidualBlock(
        (layer): RNN(
          (cell): RNNCell(
            (W_hx): Linear(in_features=384, out_features=384, bias=False)
            (activate): Tanh()
            (W_hh): Linear(in_features=384, out_features=384, bias=False)
          )
        )
        (residual): Residual()
        (norm): Normalization(
          (norm): BatchNorm1d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (drop): Dropout1d(p=0.2, inplace=False)
        (output_linear): Sequential(
          (0): Conv1d(384, 768, kernel_size=(1,), stride=(1,))
          (1): GLU(dim=-2)
        )
        (activation): GELU(approximate=none)
      )
      (4): SequenceResidualBlock(
        (layer): RNN(
          (cell): RNNCell(
            (W_hx): Linear(in_features=384, out_features=384, bias=False)
            (activate): Tanh()
            (W_hh): Linear(in_features=384, out_features=384, bias=False)
          )
        )
        (residual): Residual()
        (norm): Normalization(
          (norm): BatchNorm1d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (drop): Dropout1d(p=0.2, inplace=False)
        (output_linear): Sequential(
          (0): Conv1d(384, 768, kernel_size=(1,), stride=(1,))
          (1): GLU(dim=-2)
        )
        (activation): GELU(approximate=none)
      )
      (5): SequenceResidualBlock(
        (layer): RNN(
          (cell): RNNCell(
            (W_hx): Linear(in_features=384, out_features=384, bias=False)
            (activate): Tanh()
            (W_hh): Linear(in_features=384, out_features=384, bias=False)
          )
        )
        (residual): Residual()
        (norm): Normalization(
          (norm): BatchNorm1d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (drop): Dropout1d(p=0.2, inplace=False)
        (output_linear): Sequential(
          (0): Conv1d(384, 768, kernel_size=(1,), stride=(1,))
          (1): GLU(dim=-2)
        )
        (activation): GELU(approximate=none)
      )
      (6): SequenceResidualBlock(
        (layer): RNN(
          (cell): RNNCell(
            (W_hx): Linear(in_features=384, out_features=384, bias=False)
            (activate): Tanh()
            (W_hh): Linear(in_features=384, out_features=384, bias=False)
          )
        )
        (residual): Residual()
        (norm): Normalization(
          (norm): BatchNorm1d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (drop): Dropout1d(p=0.2, inplace=False)
        (output_linear): Sequential(
          (0): Conv1d(384, 768, kernel_size=(1,), stride=(1,))
          (1): GLU(dim=-2)
        )
        (activation): GELU(approximate=none)
      )
      (7): SequenceResidualBlock(
        (layer): RNN(
          (cell): RNNCell(
            (W_hx): Linear(in_features=384, out_features=384, bias=False)
            (activate): Tanh()
            (W_hh): Linear(in_features=384, out_features=384, bias=False)
          )
        )
        (residual): Residual()
        (norm): Normalization(
          (norm): BatchNorm1d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (drop): Dropout1d(p=0.2, inplace=False)
        (output_linear): Sequential(
          (0): Conv1d(384, 768, kernel_size=(1,), stride=(1,))
          (1): GLU(dim=-2)
        )
        (activation): GELU(approximate=none)
      )
      (8): SequenceResidualBlock(
        (layer): RNN(
          (cell): RNNCell(
            (W_hx): Linear(in_features=384, out_features=384, bias=False)
            (activate): Tanh()
            (W_hh): Linear(in_features=384, out_features=384, bias=False)
          )
        )
        (residual): Residual()
        (norm): Normalization(
          (norm): BatchNorm1d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (drop): Dropout1d(p=0.2, inplace=False)
        (output_linear): Sequential(
          (0): Conv1d(384, 768, kernel_size=(1,), stride=(1,))
          (1): GLU(dim=-2)
        )
        (activation): GELU(approximate=none)
      )
      (9): SequenceResidualBlock(
        (layer): RNN(
          (cell): RNNCell(
            (W_hx): Linear(in_features=384, out_features=384, bias=False)
            (activate): Tanh()
            (W_hh): Linear(in_features=384, out_features=384, bias=False)
          )
        )
        (residual): Residual()
        (norm): Normalization(
          (norm): BatchNorm1d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (drop): Dropout1d(p=0.2, inplace=False)
        (output_linear): Sequential(
          (0): Conv1d(384, 768, kernel_size=(1,), stride=(1,))
          (1): GLU(dim=-2)
        )
        (activation): GELU(approximate=none)
      )
      (10): SequenceResidualBlock(
        (layer): RNN(
          (cell): RNNCell(
            (W_hx): Linear(in_features=384, out_features=384, bias=False)
            (activate): Tanh()
            (W_hh): Linear(in_features=384, out_features=384, bias=False)
          )
        )
        (residual): Residual()
        (norm): Normalization(
          (norm): BatchNorm1d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (drop): Dropout1d(p=0.2, inplace=False)
        (output_linear): Sequential(
          (0): Conv1d(384, 768, kernel_size=(1,), stride=(1,))
          (1): GLU(dim=-2)
        )
        (activation): GELU(approximate=none)
      )
      (11): SequenceResidualBlock(
        (layer): RNN(
          (cell): RNNCell(
            (W_hx): Linear(in_features=384, out_features=384, bias=False)
            (activate): Tanh()
            (W_hh): Linear(in_features=384, out_features=384, bias=False)
          )
        )
        (residual): Residual()
        (norm): Normalization(
          (norm): BatchNorm1d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (drop): Dropout1d(p=0.2, inplace=False)
        (output_linear): Sequential(
          (0): Conv1d(384, 768, kernel_size=(1,), stride=(1,))
          (1): GLU(dim=-2)
        )
        (activation): GELU(approximate=none)
      )
    )
    (norm): Identity()
  )
  (encoder): Linear(
    (0): Linear(in_features=1, out_features=384, bias=True)
  )
  (decoder): SequenceDecoder(
    (0): SequenceDecoder(
      (output_transform): Linear(in_features=384, out_features=10, bias=True)
    )
  )
)
Hyperparameter groups [{'weight_decay': 0.0, 'lr': 7.5e-05}]
[2023-07-19 22:00:06,790][__main__][INFO] - Optimizer group 0 | 52 tensors | lr 0.0003 | weight_decay 0.05
[2023-07-19 22:00:06,790][__main__][INFO] - Optimizer group 1 | 24 tensors | lr 7.5e-05 | weight_decay 0.0
┏━━━┳━━━━━━━━━┳━━━━━━━━━━━━━━━━━┳━━━━━━━━┓
┃   ┃ Name    ┃ Type            ┃ Params ┃
┡━━━╇━━━━━━━━━╇━━━━━━━━━━━━━━━━━╇━━━━━━━━┩
│ 0 │ model   │ SequenceModel   │  7.1 M │
│ 1 │ encoder │ Linear          │    768 │
│ 2 │ decoder │ SequenceDecoder │  3.9 K │
└───┴─────────┴─────────────────┴────────┘
Trainable params: 7.1 M                                                         
Non-trainable params: 0                                                         
Total params: 7.1 M                                                             
Total estimated model params size (MB): 28                                      
SLURM auto-requeueing enabled. Setting signal handlers.
[2023-07-19 22:00:06,815][__main__][INFO] - Loaded 'val' dataloader:         6000 examples |    120 steps
[2023-07-19 22:00:06,816][__main__][INFO] - Loaded 'test' dataloader:       10000 examples |    200 steps
[2023-07-19 22:00:13,310][__main__][INFO] - Loaded 'train' dataloader:      54000 examples |   1080 steps
Epoch 0, global step 1080: 'val/accuracy' reached 0.13383 (best 0.13383), saving model to '/home/qvk729/Master_thesis/outputs/2023-07-19/21-59-55-226186/checkpoints/val/accuracy.ckpt' as top 1
Epoch 0/99 ━━━━━━━━━━━━━━━━ 1400/1400 0:52:09 •       1.00it/s loss: 1.84 v_num:
                                      0:00:00                  ecp8             
                                                               val/accuracy:    
                                                               0.134 val/loss:  
                                                               3.486            
                                                               test/accuracy:   
                                                               0.131 test/loss: 
                                                               3.461            
                                                               train/accuracy:  
                                                               0.207 train/loss:
                                                               2.126            
Epoch 1, global step 2160: 'val/accuracy' reached 0.38700 (best 0.38700), saving model to '/home/qvk729/Master_thesis/outputs/2023-07-19/21-59-55-226186/checkpoints/val/accuracy.ckpt' as top 1
Epoch 1/99 ━━━━━━━━━━━━━━━━ 1400/1400 0:54:10 •       1.01it/s loss: 1.53 v_num:
                                      0:00:00                  ecp8             
                                                               val/accuracy:    
                                                               0.387 val/loss:  
                                                               1.862            
                                                               test/accuracy:   
                                                               0.388 test/loss: 
                                                               1.793            
                                                               train/accuracy:  
                                                               0.38 train/loss: 
                                                               1.654            
Epoch 2, global step 3240: 'val/accuracy' was not in top 1
Epoch 2/99 ━━━━━━━━━━━━━━━━ 1400/1400 0:54:14 •       1.00it/s loss: 0.908      
                                      0:00:00                  v_num: ecp8      
                                                               val/accuracy:    
                                                               0.324 val/loss:  
                                                               3.535            
                                                               test/accuracy:   
                                                               0.332 test/loss: 
                                                               3.376            
                                                               train/accuracy:  
                                                               0.577 train/loss:
                                                               1.204            
Epoch 3, global step 4320: 'val/accuracy' was not in top 1
Epoch 3/99 ━━━━━━━━━━━━━━━━ 1400/1400 0:54:06 •       1.00it/s loss: 0.707      
                                      0:00:00                  v_num: ecp8      
                                                               val/accuracy:    
                                                               0.332 val/loss:  
                                                               2.804            
                                                               test/accuracy:   
                                                               0.338 test/loss: 
                                                               2.731            
                                                               train/accuracy:  
                                                               0.724 train/loss:
                                                               0.827            
Epoch 4, global step 5400: 'val/accuracy' reached 0.70433 (best 0.70433), saving model to '/home/qvk729/Master_thesis/outputs/2023-07-19/21-59-55-226186/checkpoints/val/accuracy.ckpt' as top 1
Epoch 4/99 ━━━━━━━━━━━━━━━━ 1400/1400 0:54:06 •       1.01it/s loss: 0.461      
                                      0:00:00                  v_num: ecp8      
                                                               val/accuracy:    
                                                               0.704 val/loss:  
                                                               1.08             
                                                               test/accuracy:   
                                                               0.731 test/loss: 
                                                               0.991            
                                                               train/accuracy:  
                                                               0.802 train/loss:
                                                               0.615            
Epoch 5, global step 6480: 'val/accuracy' reached 0.82433 (best 0.82433), saving model to '/home/qvk729/Master_thesis/outputs/2023-07-19/21-59-55-226186/checkpoints/val/accuracy.ckpt' as top 1
Epoch 5/99 ━━━━━━━━━━━━━━━━ 1400/1400 0:54:05 •       1.01it/s loss: 0.498      
                                      0:00:00                  v_num: ecp8      
                                                               val/accuracy:    
                                                               0.824 val/loss:  
                                                               0.552            
                                                               test/accuracy:   
                                                               0.834 test/loss: 
                                                               0.517            
                                                               train/accuracy:  
                                                               0.842 train/loss:
                                                               0.498            
Epoch 6, global step 7560: 'val/accuracy' reached 0.88700 (best 0.88700), saving model to '/home/qvk729/Master_thesis/outputs/2023-07-19/21-59-55-226186/checkpoints/val/accuracy.ckpt' as top 1
Epoch 6/99 ━━━━━━━━━━━━━━━━ 1400/1400 0:54:03 •       1.00it/s loss: 0.387      
                                      0:00:00                  v_num: ecp8      
                                                               val/accuracy:    
                                                               0.887 val/loss:  
                                                               0.376            
                                                               test/accuracy:   
                                                               0.896 test/loss: 
                                                               0.346            
                                                               train/accuracy:  
                                                               0.869 train/loss:
                                                               0.414            
Epoch 7, global step 8640: 'val/accuracy' was not in top 1
Epoch 7/99 ━━━━━━━━━━━━━━━━ 1400/1400 0:54:10 •       1.01it/s loss: 0.313      
                                      0:00:00                  v_num: ecp8      
                                                               val/accuracy:    
                                                               0.802 val/loss:  
                                                               0.646            
                                                               test/accuracy:   
                                                               0.818 test/loss: 
                                                               0.575            
                                                               train/accuracy:  
                                                               0.887 train/loss:
                                                               0.36             
Epoch 8, global step 9720: 'val/accuracy' was not in top 1
Epoch 8/99 ━━━━━━━━━━━━━━━━ 1400/1400 0:53:23 •       1.05it/s loss: 0.273      
                                      0:00:00                  v_num: ecp8      
                                                               val/accuracy:    
                                                               0.847 val/loss:  
                                                               0.614            
                                                               test/accuracy:   
                                                               0.858 test/loss: 
                                                               0.558            
                                                               train/accuracy:  
                                                               0.899 train/loss:
                                                               0.325            
Epoch 9, global step 10800: 'val/accuracy' was not in top 1
Epoch 9/99 ━━━━━━━━━━━━━━━━ 1400/1400 0:52:49 •       1.05it/s loss: 0.345      
                                      0:00:00                  v_num: ecp8      
                                                               val/accuracy:    
                                                               0.791 val/loss:  
                                                               0.793            
                                                               test/accuracy:   
                                                               0.797 test/loss: 
                                                               0.757            
                                                               train/accuracy:  
                                                               0.905 train/loss:
                                                               0.3              
Epoch 10, global step 11880: 'val/accuracy' reached 0.90383 (best 0.90383), saving model to '/home/qvk729/Master_thesis/outputs/2023-07-19/21-59-55-226186/checkpoints/val/accuracy.ckpt' as top 1
Epoch 10/99 ━━━━━━━━━━━━━━━ 1400/1400 0:52:55 •       1.02it/s loss: 0.259      
                                      0:00:00                  v_num: ecp8      
                                                               val/accuracy:    
                                                               0.904 val/loss:  
                                                               0.325            
                                                               test/accuracy:   
                                                               0.909 test/loss: 
                                                               0.297            
                                                               train/accuracy:  
                                                               0.918 train/loss:
                                                               0.263            
Epoch 11, global step 12960: 'val/accuracy' reached 0.92350 (best 0.92350), saving model to '/home/qvk729/Master_thesis/outputs/2023-07-19/21-59-55-226186/checkpoints/val/accuracy.ckpt' as top 1
Epoch 11/99 ━━━━━━━━━━━━━━━ 1400/1400 0:52:59 •       1.02it/s loss: 0.241      
                                      0:00:00                  v_num: ecp8      
                                                               val/accuracy:    
                                                               0.924 val/loss:  
                                                               0.254            
                                                               test/accuracy:   
                                                               0.931 test/loss: 
                                                               0.232            
                                                               train/accuracy:  
                                                               0.924 train/loss:
                                                               0.242            
Epoch 12, global step 14040: 'val/accuracy' was not in top 1
Epoch 12/99 ━━━━━━━━━━━━━━━ 1400/1400 0:52:54 •       1.02it/s loss: 0.236      
                                      0:00:00                  v_num: ecp8      
                                                               val/accuracy:    
                                                               0.832 val/loss:  
                                                               0.612            
                                                               test/accuracy:   
                                                               0.842 test/loss: 
                                                               0.558            
                                                               train/accuracy:  
                                                               0.932 train/loss:
                                                               0.218            
Epoch 13, global step 15120: 'val/accuracy' was not in top 1
Epoch 13/99 ━━━━━━━━━━━━━━━ 1400/1400 0:54:38 •       1.00it/s loss: 0.218      
                                      0:00:00                  v_num: ecp8      
                                                               val/accuracy:    
                                                               0.784 val/loss:  
                                                               0.762            
                                                               test/accuracy:   
                                                               0.789 test/loss: 
                                                               0.715            
                                                               train/accuracy:  
                                                               0.936 train/loss:
                                                               0.204            
Epoch 14, global step 16200: 'val/accuracy' was not in top 1
Epoch 14/99 ━━━━━━━━━━━━━━━ 1400/1400 0:54:43 •       0.99it/s loss: 0.182      
                                      0:00:00                  v_num: ecp8      
                                                               val/accuracy:    
                                                               0.886 val/loss:  
                                                               0.386            
                                                               test/accuracy:   
                                                               0.889 test/loss: 
                                                               0.369            
                                                               train/accuracy:  
                                                               0.941 train/loss:
                                                               0.191            
Epoch 15, global step 17280: 'val/accuracy' was not in top 1
Epoch 15/99 ━━━━━━━━━━━━━━━ 1400/1400 0:54:47 •       0.99it/s loss: 0.18 v_num:
                                      0:00:00                  ecp8             
                                                               val/accuracy:    
                                                               0.917 val/loss:  
                                                               0.277            
                                                               test/accuracy:   
                                                               0.924 test/loss: 
                                                               0.243            
                                                               train/accuracy:  
                                                               0.944 train/loss:
                                                               0.177            
Epoch 16, global step 18360: 'val/accuracy' reached 0.93800 (best 0.93800), saving model to '/home/qvk729/Master_thesis/outputs/2023-07-19/21-59-55-226186/checkpoints/val/accuracy.ckpt' as top 1
Epoch 16/99 ━━━━━━━━━━━━━━━ 1400/1400 0:54:40 •       0.99it/s loss: 0.175      
                                      0:00:00                  v_num: ecp8      
                                                               val/accuracy:    
                                                               0.938 val/loss:  
                                                               0.212            
                                                               test/accuracy:   
                                                               0.945 test/loss: 
                                                               0.188            
                                                               train/accuracy:  
                                                               0.948 train/loss:
                                                               0.165            
Epoch 17, global step 19440: 'val/accuracy' was not in top 1
Epoch 17/99 ━━━━━━━━━━━━━━━ 1400/1400 0:54:43 •       1.00it/s loss: 0.175      
                                      0:00:00                  v_num: ecp8      
                                                               val/accuracy:    
                                                               0.922 val/loss:  
                                                               0.263            
                                                               test/accuracy:   
                                                               0.927 test/loss: 
                                                               0.252            
                                                               train/accuracy:  
                                                               0.949 train/loss:
                                                               0.161            
Epoch 18, global step 20520: 'val/accuracy' reached 0.94733 (best 0.94733), saving model to '/home/qvk729/Master_thesis/outputs/2023-07-19/21-59-55-226186/checkpoints/val/accuracy.ckpt' as top 1
Epoch 18/99 ━━━━━━━━━━━━━━━ 1400/1400 0:53:43 •       1.01it/s loss: 0.146      
                                      0:00:00                  v_num: ecp8      
                                                               val/accuracy:    
                                                               0.947 val/loss:  
                                                               0.181            
                                                               test/accuracy:   
                                                               0.951 test/loss: 
                                                               0.16             
                                                               train/accuracy:  
                                                               0.953 train/loss:
                                                               0.148            
Epoch 19, global step 21600: 'val/accuracy' was not in top 1
Epoch 19/99 ━━━━━━━━━━━━━━━ 1400/1400 0:53:09 •       1.02it/s loss: 0.19 v_num:
                                      0:00:00                  ecp8             
                                                               val/accuracy:    
                                                               0.923 val/loss:  
                                                               0.265            
                                                               test/accuracy:   
                                                               0.927 test/loss: 
                                                               0.241            
                                                               train/accuracy:  
                                                               0.956 train/loss:
                                                               0.139            
Epoch 20, global step 22680: 'val/accuracy' reached 0.94950 (best 0.94950), saving model to '/home/qvk729/Master_thesis/outputs/2023-07-19/21-59-55-226186/checkpoints/val/accuracy.ckpt' as top 1
Epoch 20/99 ━━━━━━━━━━━━━━━ 1400/1400 0:53:48 •       0.99it/s loss: 0.108      
                                      0:00:00                  v_num: ecp8      
                                                               val/accuracy:    
                                                               0.95 val/loss:   
                                                               0.177            
                                                               test/accuracy:   
                                                               0.955 test/loss: 
                                                               0.155            
                                                               train/accuracy:  
                                                               0.956 train/loss:
                                                               0.136            
Epoch 21, global step 23760: 'val/accuracy' reached 0.95700 (best 0.95700), saving model to '/home/qvk729/Master_thesis/outputs/2023-07-19/21-59-55-226186/checkpoints/val/accuracy.ckpt' as top 1
Epoch 21/99 ━━━━━━━━━━━━━━━ 1400/1400 0:54:20 •       0.99it/s loss: 0.124      
                                      0:00:00                  v_num: ecp8      
                                                               val/accuracy:    
                                                               0.957 val/loss:  
                                                               0.144            
                                                               test/accuracy:   
                                                               0.961 test/loss: 
                                                               0.124            
                                                               train/accuracy:  
                                                               0.958 train/loss:
                                                               0.13             
Epoch 22, global step 24840: 'val/accuracy' was not in top 1
Epoch 22/99 ━━━━━━━━━━━━━━━ 1400/1400 0:54:17 •       1.02it/s loss: 0.135      
                                      0:00:00                  v_num: ecp8      
                                                               val/accuracy:    
                                                               0.949 val/loss:  
                                                               0.17             
                                                               test/accuracy:   
                                                               0.955 test/loss: 
                                                               0.147            
                                                               train/accuracy:  
                                                               0.962 train/loss:
                                                               0.119            
Epoch 23, global step 25920: 'val/accuracy' was not in top 1
Epoch 23/99 ━━━━━━━━━━━━━━━ 1400/1400 0:53:39 •       0.99it/s loss: 0.127      
                                      0:00:00                  v_num: ecp8      
                                                               val/accuracy:    
                                                               0.954 val/loss:  
                                                               0.167            
                                                               test/accuracy:   
                                                               0.959 test/loss: 
                                                               0.139            
                                                               train/accuracy:  
                                                               0.963 train/loss:
                                                               0.117            
Epoch 24, global step 27000: 'val/accuracy' was not in top 1
Epoch 24/99 ━━━━━━━━━━━━━━━ 1400/1400 0:52:01 •       1.09it/s loss: 0.141      
                                      0:00:00                  v_num: ecp8      
                                                               val/accuracy:    
                                                               0.839 val/loss:  
                                                               0.571            
                                                               test/accuracy:   
                                                               0.854 test/loss: 
                                                               0.511            
                                                               train/accuracy:  
                                                               0.966 train/loss:
                                                               0.111            
Epoch 25, global step 28080: 'val/accuracy' reached 0.96100 (best 0.96100), saving model to '/home/qvk729/Master_thesis/outputs/2023-07-19/21-59-55-226186/checkpoints/val/accuracy.ckpt' as top 1
Epoch 25/99 ━━━━━━━━━━━━━━━ 1400/1400 0:52:04 •       1.03it/s loss: 0.119      
                                      0:00:00                  v_num: ecp8      
                                                               val/accuracy:    
                                                               0.961 val/loss:  
                                                               0.144            
                                                               test/accuracy:   
                                                               0.964 test/loss: 
                                                               0.113            
                                                               train/accuracy:  
                                                               0.966 train/loss:
                                                               0.106            
Epoch 26, global step 29160: 'val/accuracy' reached 0.96117 (best 0.96117), saving model to '/home/qvk729/Master_thesis/outputs/2023-07-19/21-59-55-226186/checkpoints/val/accuracy.ckpt' as top 1
Epoch 26/99 ━━━━━━━━━━━━━━━ 1400/1400 0:50:42 •       1.11it/s loss: 0.0871     
                                      0:00:00                  v_num: ecp8      
                                                               val/accuracy:    
                                                               0.961 val/loss:  
                                                               0.13             
                                                               test/accuracy:   
                                                               0.964 test/loss: 
                                                               0.116            
                                                               train/accuracy:  
                                                               0.969 train/loss:
                                                               0.099            
Epoch 27, global step 30240: 'val/accuracy' reached 0.96217 (best 0.96217), saving model to '/home/qvk729/Master_thesis/outputs/2023-07-19/21-59-55-226186/checkpoints/val/accuracy.ckpt' as top 1
Epoch 27/99 ━━━━━━━━━━━━━━━ 1400/1400 0:52:44 •       1.08it/s loss: 0.111      
                                      0:00:00                  v_num: ecp8      
                                                               val/accuracy:    
                                                               0.962 val/loss:  
                                                               0.133            
                                                               test/accuracy:   
                                                               0.965 test/loss: 
                                                               0.111            
                                                               train/accuracy:  
                                                               0.969 train/loss:
                                                               0.095            
Epoch 28, global step 31320: 'val/accuracy' was not in top 1
Epoch 28/99 ━━━━━━━━━━━━━━━ 1400/1400 0:50:43 •       1.00it/s loss: 0.0713     
                                      0:00:00                  v_num: ecp8      
                                                               val/accuracy:    
                                                               0.957 val/loss:  
                                                               0.154            
                                                               test/accuracy:   
                                                               0.959 test/loss: 
                                                               0.138            
                                                               train/accuracy:  
                                                               0.97 train/loss: 
                                                               0.093            
Epoch 29, global step 32400: 'val/accuracy' was not in top 1
Epoch 29/99 ━━━━━━━━━━━━━━━ 1400/1400 0:53:46 •       1.06it/s loss: 0.0712     
                                      0:00:00                  v_num: ecp8      
                                                               val/accuracy:    
                                                               0.962 val/loss:  
                                                               0.137            
                                                               test/accuracy:   
                                                               0.967 test/loss: 
                                                               0.109            
                                                               train/accuracy:  
                                                               0.971 train/loss:
                                                               0.091            
Epoch 30, global step 33480: 'val/accuracy' was not in top 1
Epoch 30/99 ━━━━━━━━━━━━━━━ 1400/1400 0:50:45 •       1.08it/s loss: 0.116      
                                      0:00:00                  v_num: ecp8      
                                                               val/accuracy:    
                                                               0.924 val/loss:  
                                                               0.259            
                                                               test/accuracy:   
                                                               0.924 test/loss: 
                                                               0.255            
                                                               train/accuracy:  
                                                               0.973 train/loss:
                                                               0.081            
Epoch 31, global step 34560: 'val/accuracy' was not in top 1
Epoch 31/99 ━━━━━━━━━━━━━━━ 1400/1400 0:49:59 •       1.08it/s loss: 0.102      
                                      0:00:00                  v_num: ecp8      
                                                               val/accuracy:    
                                                               0.961 val/loss:  
                                                               0.144            
                                                               test/accuracy:   
                                                               0.962 test/loss: 
                                                               0.128            
                                                               train/accuracy:  
                                                               0.974 train/loss:
                                                               0.08             
Epoch 32, global step 35640: 'val/accuracy' was not in top 1
Epoch 32/99 ━━━━━━━━━━━━━━━ 1400/1400 0:49:58 •       1.10it/s loss: 0.0879     
                                      0:00:00                  v_num: ecp8      
                                                               val/accuracy:    
                                                               0.956 val/loss:  
                                                               0.165            
                                                               test/accuracy:   
                                                               0.959 test/loss: 
                                                               0.135            
                                                               train/accuracy:  
                                                               0.975 train/loss:
                                                               0.076            
Epoch 33, global step 36720: 'val/accuracy' reached 0.96283 (best 0.96283), saving model to '/home/qvk729/Master_thesis/outputs/2023-07-19/21-59-55-226186/checkpoints/val/accuracy.ckpt' as top 1
Epoch 33/99 ━━━━━━━━━━━━━━━ 1400/1400 0:50:05 •       1.10it/s loss: 0.0729     
                                      0:00:00                  v_num: ecp8      
                                                               val/accuracy:    
                                                               0.963 val/loss:  
                                                               0.141            
                                                               test/accuracy:   
                                                               0.966 test/loss: 
                                                               0.12             
                                                               train/accuracy:  
                                                               0.977 train/loss:
                                                               0.071            
Epoch 34, global step 37800: 'val/accuracy' was not in top 1
Epoch 34/99 ━━━━━━━━━━━━━━━ 1400/1400 0:49:54 •       1.09it/s loss: 0.0433     
                                      0:00:00                  v_num: ecp8      
                                                               val/accuracy:    
                                                               0.961 val/loss:  
                                                               0.147            
                                                               test/accuracy:   
                                                               0.966 test/loss: 
                                                               0.118            
                                                               train/accuracy:  
                                                               0.976 train/loss:
                                                               0.073            
Epoch 35, global step 38880: 'val/accuracy' was not in top 1
Epoch 35/99 ━━━━━━━━━━━━━━━ 1400/1400 0:50:03 •       1.09it/s loss: 0.0671     
                                      0:00:00                  v_num: ecp8      
                                                               val/accuracy:    
                                                               0.942 val/loss:  
                                                               0.212            
                                                               test/accuracy:   
                                                               0.949 test/loss: 
                                                               0.185            
                                                               train/accuracy:  
                                                               0.977 train/loss:
                                                               0.067            
Epoch 36, global step 39960: 'val/accuracy' was not in top 1
Epoch 36/99 ━━━━━━━━━━━━━━━ 1400/1400 0:49:58 •       1.10it/s loss: 0.0725     
                                      0:00:00                  v_num: ecp8      
                                                               val/accuracy:    
                                                               0.962 val/loss:  
                                                               0.125            
                                                               test/accuracy:   
                                                               0.969 test/loss: 
                                                               0.112            
                                                               train/accuracy:  
                                                               0.979 train/loss:
                                                               0.063            
Epoch 37, global step 41040: 'val/accuracy' reached 0.96633 (best 0.96633), saving model to '/home/qvk729/Master_thesis/outputs/2023-07-19/21-59-55-226186/checkpoints/val/accuracy.ckpt' as top 1
Epoch 37/99 ━━━━━━━━━━━━━━━ 1400/1400 0:50:00 •       1.10it/s loss: 0.0475     
                                      0:00:00                  v_num: ecp8      
                                                               val/accuracy:    
                                                               0.966 val/loss:  
                                                               0.128            
                                                               test/accuracy:   
                                                               0.969 test/loss: 
                                                               0.105            
                                                               train/accuracy:  
                                                               0.98 train/loss: 
                                                               0.059            
Epoch 38, global step 42120: 'val/accuracy' was not in top 1
Epoch 38/99 ━━━━━━━━━━━━━━━ 1400/1400 0:49:53 •       1.09it/s loss: 0.0472     
                                      0:00:00                  v_num: ecp8      
                                                               val/accuracy:    
                                                               0.964 val/loss:  
                                                               0.135            
                                                               test/accuracy:   
                                                               0.969 test/loss: 
                                                               0.114            
                                                               train/accuracy:  
                                                               0.98 train/loss: 
                                                               0.059            
Epoch 39, global step 43200: 'val/accuracy' was not in top 1
Epoch 39/99 ━━━━━━━━━━━━━━━ 1400/1400 0:49:58 •       1.10it/s loss: 0.0563     
                                      0:00:00                  v_num: ecp8      
                                                               val/accuracy:    
                                                               0.966 val/loss:  
                                                               0.136            
                                                               test/accuracy:   
                                                               0.966 test/loss: 
                                                               0.12             
                                                               train/accuracy:  
                                                               0.981 train/loss:
                                                               0.055            
Epoch 40, global step 44280: 'val/accuracy' was not in top 1
Epoch 40/99 ━━━━━━━━━━━━━━━ 1400/1400 0:50:03 •       1.08it/s loss: 0.0452     
                                      0:00:00                  v_num: ecp8      
                                                               val/accuracy:    
                                                               0.965 val/loss:  
                                                               0.145            
                                                               test/accuracy:   
                                                               0.968 test/loss: 
                                                               0.121            
                                                               train/accuracy:  
                                                               0.982 train/loss:
                                                               0.055            
Epoch 41, global step 45360: 'val/accuracy' was not in top 1
Epoch 41/99 ━━━━━━━━━━━━━━━ 1400/1400 0:51:37 •       1.06it/s loss: 0.0625     
                                      0:00:00                  v_num: ecp8      
                                                               val/accuracy:    
                                                               0.966 val/loss:  
                                                               0.137            
                                                               test/accuracy:   
                                                               0.969 test/loss: 
                                                               0.116            
                                                               train/accuracy:  
                                                               0.983 train/loss:
                                                               0.051            
Epoch 42, global step 46440: 'val/accuracy' was not in top 1
Epoch 42/99 ━━━━━━━━━━━━━━━ 1400/1400 0:52:57 •       1.03it/s loss: 0.0453     
                                      0:00:00                  v_num: ecp8      
                                                               val/accuracy:    
                                                               0.966 val/loss:  
                                                               0.137            
                                                               test/accuracy:   
                                                               0.972 test/loss: 
                                                               0.111            
                                                               train/accuracy:  
                                                               0.984 train/loss:
                                                               0.046            
Epoch 43, global step 47520: 'val/accuracy' reached 0.96817 (best 0.96817), saving model to '/home/qvk729/Master_thesis/outputs/2023-07-19/21-59-55-226186/checkpoints/val/accuracy.ckpt' as top 1
Epoch 43/99 ━━━━━━━━━━━━━━━ 1400/1400 0:53:26 •       1.01it/s loss: 0.0514     
                                      0:00:00                  v_num: ecp8      
                                                               val/accuracy:    
                                                               0.968 val/loss:  
                                                               0.143            
                                                               test/accuracy:   
                                                               0.971 test/loss: 
                                                               0.115            
                                                               train/accuracy:  
                                                               0.985 train/loss:
                                                               0.045            
Epoch 44, global step 48600: 'val/accuracy' was not in top 1
Epoch 44/99 ━━━━━━━━━━━━━━━ 1400/1400 0:53:00 •       1.03it/s loss: 0.0396     
                                      0:00:00                  v_num: ecp8      
                                                               val/accuracy:    
                                                               0.967 val/loss:  
                                                               0.14             
                                                               test/accuracy:   
                                                               0.969 test/loss: 
                                                               0.118            
                                                               train/accuracy:  
                                                               0.985 train/loss:
                                                               0.043            
Epoch 45, global step 49680: 'val/accuracy' was not in top 1
Epoch 45/99 ━━━━━━━━━━━━━━━ 1400/1400 0:52:53 •       1.03it/s loss: 0.0483     
                                      0:00:00                  v_num: ecp8      
                                                               val/accuracy:    
                                                               0.967 val/loss:  
                                                               0.146            
                                                               test/accuracy:   
                                                               0.97 test/loss:  
                                                               0.12             
                                                               train/accuracy:  
                                                               0.985 train/loss:
                                                               0.042            
Epoch 46, global step 50760: 'val/accuracy' reached 0.96883 (best 0.96883), saving model to '/home/qvk729/Master_thesis/outputs/2023-07-19/21-59-55-226186/checkpoints/val/accuracy.ckpt' as top 1
Epoch 46/99 ━━━━━━━━━━━━━━━ 1400/1400 0:50:07 •       1.10it/s loss: 0.0457     
                                      0:00:00                  v_num: ecp8      
                                                               val/accuracy:    
                                                               0.969 val/loss:  
                                                               0.131            
                                                               test/accuracy:   
                                                               0.97 test/loss:  
                                                               0.109            
                                                               train/accuracy:  
                                                               0.987 train/loss:
                                                               0.039            
Epoch 47, global step 51840: 'val/accuracy' was not in top 1
Epoch 47/99 ━━━━━━━━━━━━━━━ 1400/1400 0:50:04 •       1.08it/s loss: 0.0414     
                                      0:00:00                  v_num: ecp8      
                                                               val/accuracy:    
                                                               0.965 val/loss:  
                                                               0.15             
                                                               test/accuracy:   
                                                               0.969 test/loss: 
                                                               0.125            
                                                               train/accuracy:  
                                                               0.988 train/loss:
                                                               0.036            
Epoch 48, global step 52920: 'val/accuracy' reached 0.96950 (best 0.96950), saving model to '/home/qvk729/Master_thesis/outputs/2023-07-19/21-59-55-226186/checkpoints/val/accuracy.ckpt' as top 1
Epoch 48/99 ━━━━━━━━━━━━━━━ 1400/1400 0:50:07 •       1.08it/s loss: 0.0323     
                                      0:00:00                  v_num: ecp8      
                                                               val/accuracy:    
                                                               0.97 val/loss:   
                                                               0.133            
                                                               test/accuracy:   
                                                               0.972 test/loss: 
                                                               0.105            
                                                               train/accuracy:  
                                                               0.987 train/loss:
                                                               0.037            
Epoch 49, global step 54000: 'val/accuracy' was not in top 1
Epoch 49/99 ━━━━━━━━━━━━━━━ 1400/1400 0:52:32 •       1.09it/s loss: 0.0245     
                                      0:00:00                  v_num: ecp8      
                                                               val/accuracy:    
                                                               0.966 val/loss:  
                                                               0.139            
                                                               test/accuracy:   
                                                               0.969 test/loss: 
                                                               0.116            
                                                               train/accuracy:  
                                                               0.989 train/loss:
                                                               0.031            
Epoch 50, global step 55080: 'val/accuracy' reached 0.97267 (best 0.97267), saving model to '/home/qvk729/Master_thesis/outputs/2023-07-19/21-59-55-226186/checkpoints/val/accuracy.ckpt' as top 1
Epoch 50/99 ━━━━━━━━━━━━━━━ 1400/1400 0:54:00 •       1.00it/s loss: 0.0224     
                                      0:00:00                  v_num: ecp8      
                                                               val/accuracy:    
                                                               0.973 val/loss:  
                                                               0.121            
                                                               test/accuracy:   
                                                               0.973 test/loss: 
                                                               0.108            
                                                               train/accuracy:  
                                                               0.988 train/loss:
                                                               0.033            
Epoch 51, global step 56160: 'val/accuracy' was not in top 1
Epoch 51/99 ━━━━━━━━━━━━━━━ 1400/1400 0:54:09 •       1.00it/s loss: 0.0264     
                                      0:00:00                  v_num: ecp8      
                                                               val/accuracy:    
                                                               0.972 val/loss:  
                                                               0.126            
                                                               test/accuracy:   
                                                               0.971 test/loss: 
                                                               0.106            
                                                               train/accuracy:  
                                                               0.989 train/loss:
                                                               0.031            
Epoch 52, global step 57240: 'val/accuracy' was not in top 1
Epoch 52/99 ━━━━━━━━━━━━━━━ 1400/1400 0:54:11 •       1.01it/s loss: 0.0345     
                                      0:00:00                  v_num: ecp8      
                                                               val/accuracy:    
                                                               0.972 val/loss:  
                                                               0.117            
                                                               test/accuracy:   
                                                               0.974 test/loss: 
                                                               0.103            
                                                               train/accuracy:  
                                                               0.991 train/loss:
                                                               0.025            
